MPC-PolyPhen
==============================

Python module to get MPC values and PolyPhen label predictions for a set of patients and mutations. \
*Last update: Sep 10, 2019*

Project Organization
------------

    ├── README.md          <- The top-level README for developers using this project.
    │
    ├── analysis           <- The protocol execution logs final and the final annotation files created  
    │                         by the code, if an alternative path is not provided under the --path parameter.
    ├── data
    │   ├── processed      <- The partitioned chunks of the MPC official values original file.
    │   └── raw            <- The original, immutable data dump: patients, mutations and MPC values file.
    │
    ├── environment.yml   <- The requirements file for reproducing the analysis environment.
    │
    ├── notebooks          <- Jupyter notebooks not provided for this project.
    │
    ├── references         <- The MPC-PolyPhen module official presentation.
    │
    ├── reports            <- No specific reports generated by this project.
    │   └── figures        <- No specific graphics or figures generated by this project.
    │
    ├── src                <- Source code for use in this project: module getMPC.py
    │   └── __init__.py    
    │
    ├── main.py            <- Execution script for the src code: main.py


### Description

This repo contains a Python module to annotate MPC values and pph2 prediction labels to a set 
of patients and mutations. The project's module is function-oriented-programming protocol 
is executed by calling a 
[main script](https://github.com/mgmartinezl/Stalicla-MPC-PolyPhen/blob/master/main.py)
based on the 
[src code](https://github.com/mgmartinezl/Stalicla-MPC-PolyPhen/blob/master/src/) 
provided. 

How to run this script
------------
This module is written in Python 3 and uses up-to-date libraries 
for this version as well. To run the main module in a Linux environment, 
simply open a new terminal and call the script together with the arguments 
it accepts:

```python3 main.py ``` \
```positional arguments: ``` \
&nbsp;&nbsp;&nbsp;```[inputFile] [inputMPC]``` \
```optional arguments: ``` \
&nbsp;&nbsp;&nbsp;```[-g GENE, --gene GENE, --genes GENE]``` \
&nbsp;&nbsp;&nbsp;```[-id PATIENT, --patient PATIENT, --patients PATIENT]``` \
&nbsp;&nbsp;&nbsp;```[-csq CSQ, --consequence CSQ, --consequences CSQ]``` \
&nbsp;&nbsp;&nbsp;```[-mpc MPC, --mpc_gt MPC]``` \
&nbsp;&nbsp;&nbsp;```[-pph2 PPH2, --polyphen PPH2, --polyphen2 PPH2]``` \
&nbsp;&nbsp;&nbsp;```[-adj_csq ADJ-CSQ, --adjusted_consequence ADJ-CSQ, --adjusted_consequences ADJ-CSQ]``` \
&nbsp;&nbsp;&nbsp;```[--path PATH-RESULTS]``` 

Positional arguments
------------
* **inputFile:** it is mandatory to specify the absolute path to the input file 
containing the patients and their mutations.
    - Example: \
    ```$ python3 main.py ~/data/raw/mutations-file.txt```
* **inputMPC:**  it is mandatory to specify the absolute path to the directory that 
contains the MPC official values file. It is also possible to set a path to a directory that
contains chunks of the original file when it is partitioned.
    - Example 1: ```$ python3 main.py ~/data/raw/mutations-file.txt ~/data/raw/mpc-official-values-file.txt```
    - Example 2: ```$ python3 main.py ~/data/raw/mutations-file.txt ~/data/raw/mpc-official-values-directory```

**Important notes:** 
- Be aware of respecting the order of the positional arguments.
- Also, keep the names of the patients and mutations file as follows: \
```Chr, Position, Ref, Alt, Type, Gene, consequence, AA_Change, BP_Change, child_id, HGNC_symbol, HGNC_mapping, constraint_score, pLI, pRecessive, max_control_AF, pph2_prediction, MPC, adjusted_consequence```
- If an MPC official values file is provided, it must be a txt tab separated file (txt). 
- If chunks of MPC official values are provided, they must be comma separated files (csv).

Optional arguments
------------

* **[-g GENE, --gene GENE, --genes GENE]:** 
optional argument to filter specific genes. 
If no setting is provided, all available genes will be considered.
    - Example: protocol will filter data for gene CTR9 \
    ```$ python3 main.py ~/data/raw/mutations-file.txt ~/data/raw/mpc-official-values-file.txt -g CTR9 ```
   
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
To filter by more than one gene, you can specify one of the following: \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    1. A subset of genes separated by comma (without spaces):  \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    ```-g CTR9,NOCL2 ``` \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    2. A txt tab delimited file with no headers and the desired genes to filter written in the first column: \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    ```-g ~/PBPM/data/raw/filters/my-file-containing-genes.txt``` 

* **[-id PATIENT, --patient PATIENT, --patients PATIENT]:** 
optional argument to filter specific patient IDs. 
If no setting is provided, all available patients will be considered.
    - Example: protocol will filter data for patient with ID 1 \
    ```$ python3 main.py ~/data/raw/mutations-file.txt ~/data/raw/mpc-official-values-file.txt -id Patient_1 ```
   
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
To filter by more than one patient ID, you can specify one of the following: \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    1. A subset of patients separated by comma (without spaces):  \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    ```-id Patient_X,Patient_Y ``` \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    2. A txt tab delimited file with no headers and the desired patient IDs to filter written in the first column: \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    ```-id ~/data/raw/filters/my-file-containing-patients.txt``` 

* **[-csq CSQ, --consequence CSQ, --consequences CSQ]:** 
optional argument to filter specific consequences. 
If no setting is provided, all available consequences will be considered.
    - Example: protocol will filter data for consequences of type 'missense_variant' \
    ```$ python3 main.py ~/data/raw/mutations-file.txt ~/data/raw/mpc-official-values-file.txt -csq missense_variant```
   
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
To filter by more than one consequence, you can specify one of the following: \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    1. A subset of consequences separated by comma (without spaces):  \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    ```-csq missense_variant,Intron ``` \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    2. A txt tab delimited file with no headers and the desired consequences to filter written in the first column: \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    ```-csq ~/data/raw/filters/my-file-containing-mutations.txt``` 

* **[-mpc MPC, --mpc_gt MPC]:** 
optional argument to filter records with values greater than or equal to a specified 
MPC threshold.
    - Example: ```$ python3 main.py ~/data/raw/mutations-file.txt ~/data/raw/mpc-official-values-file.txt -mpc 0.7 ```

* **[-pph2 PPH2, --polyphen PPH2, --polyphen2 PPH2]:** 
optional argument to filter records with specific PolyPhen predictions. 
Available options for this parameter are: *benign*, *possibly damaging*, 
and *probably damaging*. Note that qualifiers must be enclosed with 
quotes as they hold blank spaces.
    - Example:  ```$ python3 main.py ~/data/raw/mutations-file.txt ~/data/raw/mpc-official-values-file.txt -pph2 "possibly damaging" ```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
To filter by more than one PolyPhen qualifier, you must separate their labels with comma and without spaces while keeping the quotes: \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ``` -pph2 "probably damaging,possibly damaging" ```

* **[-adj_csq ADJ-CSQ, --adjusted_consequence ADJ-CSQ, --adjusted_consequences ADJ-CSQ]:** 
optional argument to filter records by specific adjusted consequence labels. 
Available options for this parameter include: *PTV*, *Missense3*, *Missense*, etc. 
    - Example:  ```$ python3 main.py ~/data/raw/mutations-file.txt ~/data/raw/mpc-official-values-file.txt -adj_csq PTV ```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
To filter by more than one adjusted consequence, you must separate their labels with comma: \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ``` -adj_csq Missense3,Missense ```

* **[--path PATH-RESULTS]:** 
optional argument to specify the path where the user wants to store the final annotated file.
When not specified, the final file will be stored in the **analysis** folder of this project.
    
**Note:** help() is available for all the parameters via the command line by running
```python main.py --help``` :smile:

***
<p><small>
For any additional information, contact me :bowtie: 

*Gabriela Martinez* <br>
*airamgabriela17@gmail.com*
</small></p>
***

<p><small>Project based on the <a target="_blank" href="https://drivendata.github.io/cookiecutter-data-science/">cookiecutter data science project template</a>. #cookiecutterdatascience</small></p>
